//==================================================================================================
//  文件功能: DELAY-延迟函数
//  文件说明: 暂无
//  文件类型: APP-特殊执行程序文件
//--------------------------------------------------------------------------------------------------
//  硬件平台: STC89C52RC
//  软件平台: Keil uVision4 C51 
//--------------------------------------------------------------------------------------------------
//  开发组织: 大小林生的店
//  开发作者: 大小林生
//  官方网站: https://www.daxiaolinsheng.com/
//  官方商城: https://daxiaolinsheng.taobao.com/
//  微信平台: 大小林生
//  产品链接: 暂无
//  版权信息: 文件的内容版权为大小林生的店拥有，使用时请注明版权出处！
//--------------------------------------------------------------------------------------------------
//  更新时间: 2017-11-10
//  更新内容: 详情见更新日志
//==================================================================================================

//--------------------------------------------------------------------------------------------------
//  包含的头文件    |   0   |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   
//--------------------------------------------------------------------------------------------------
#include"MAIN.H"                                    // 包含全局头文件，
#include"DELAY.H"                                   // 包含外设头文件，DELAY-延时

//--------------------------------------------------------------------------------------------------
//  宏自定义声明    |   0   |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   
//--------------------------------------------------------------------------------------------------
//  DELAY 工作模式
#define DELAY_MODE_SOFTWARE         1               // DELAY操作模式 SOFTWARE - 软件模拟

#define DELAY_MODE                  DELAY_MODE_SOFTWARE             // 软件模拟
//--------------------------------------------------------------------------------------------------
//  定义引用变量    |   0   |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   
//--------------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------------
//  硬件端口定义    |   0   |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   
//--------------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------------
//  引用函数声明    |   0   |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   
//--------------------------------------------------------------------------------------------------
void DELAY_Init(void);
void DELAY_nUS(unsigned char Time);
void DELAY_nMS(unsigned int Time);


//==================================================================================================
//  函数功能: 延迟函数 初始化
//  函数标记: 应用函数
//  函数说明: 利用SysTick实现延迟
//--------------------------------------------------------------------------------------------------
//  输入参量: 无
//  输出参量: 无
//--------------------------------------------------------------------------------------------------
//  |   -   |   -   |   0   |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9
//==================================================================================================
void DELAY_Init(void)
{
    //----------------------------------------------------------------------------------------------
    // 软件模拟
    //----------------------------------------------------------------------------------------------
    #if (DELAY_MODE == DELAY_MODE_SOFTWARE)
    {

    }
    #endif
}


//==================================================================================================
//  函数功能: 延迟函数 延迟2US倍数
//  函数标记: 应用函数
//  函数说明: 将char型改为int型，会加大误差
//--------------------------------------------------------------------------------------------------
//  输入参量: Time: 延迟的毫秒数；取值范围: 1~65535；
//  输出参量: 无
//--------------------------------------------------------------------------------------------------
//  |   -   |   -   |   0   |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9
//==================================================================================================
//void DELAY_nUS(unsigned char Time)
//{
//    //----------------------------------------------------------------------------------------------
//    // 软件模拟
//    //----------------------------------------------------------------------------------------------
//    #if (DELAY_MODE == DELAY_MODE_SOFTWARE)
//    {
//        while(--Time);
//    }
//    #endif
//}

//==================================================================================================
//  函数功能: 延迟函数 延迟1MS倍数
//  函数标记: 应用函数
//  函数说明: 
//--------------------------------------------------------------------------------------------------
//  输入参量: Time: 延迟的微秒数；取值范围: 1~65535；
//  输出参量: 无
//--------------------------------------------------------------------------------------------------
//  |   -   |   -   |   0   |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9
//==================================================================================================
void DELAY_nMS(unsigned int Time)
{
    //----------------------------------------------------------------------------------------------
    // 软件模拟	 11.05926晶振
    //----------------------------------------------------------------------------------------------
    unsigned int i;
	unsigned int j;
	for(i=0;i<Time;i++)
	{
		for(j=0;j<938;j++);
	}
	
}
void delay(unsigned int time)              //int型数据为16位,所以最大值为65535            
 {										   //0.1ms
  unsigned int  i,j;                  //定义变量i,j,用于循环语句 
  for(i=0;i<time;i++)         //for循环,循环50*time次
     for(j=0;j<50;j++);       //for循环,循环50次
 }
 //**************************************************************************************************
//精确延时函数(使用12M晶振，延时T=2*t+5个指令周期,t为char型,改为int型,会加大误差）
//**************************************************************************************************
void delay_us(unsigned int t)
{
 while(--t);
}
